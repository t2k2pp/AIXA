<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIeräº¤æ¸‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- å…¨ä½“ã‚¹ã‚¿ã‚¤ãƒ« --- */
        :root {
            --primary-color: #00529B;
            --secondary-color: #00A3E0;
            --accent-color: #FFC107;
            --bg-color: #f0f4f8;
            --text-color: #333;
            --white-color: #ffffff;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --border-radius: 12px;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            transition: background-color 1s ease;
        }

        /* --- ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ --- */
        #game-container {
            width: 100%;
            max-width: 900px;
            background-color: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- ç”»é¢ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« --- */
        .screen {
            padding: 30px 40px;
            box-sizing: border-box;
        }

        /* --- ã‚·ãƒŠãƒªã‚ªé¸æŠç”»é¢ --- */
        #scenario-selection-screen {
            text-align: center;
        }
        #scenario-selection-screen h1 {
            color: var(--primary-color);
        }
        #scenario-selection-screen p {
            color: #666;
            margin-bottom: 30px;
        }
        .scenario-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .scenario-button {
            background-color: var(--primary-color);
            color: var(--white-color);
            border: none;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            text-align: left;
        }
        .scenario-button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }
        .scenario-button .industry {
            font-size: 0.8em;
            opacity: 0.8;
            display: block;
            margin-bottom: 5px;
        }

        /* --- ã‚²ãƒ¼ãƒ ç”»é¢ --- */
        #game-screen {
            display: none; /* åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º */
        }

        /* ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒªã‚¢ */
        #client-area {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }
        #client-icon {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background-color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em;
            transition: transform 0.5s ease;
        }
        #client-dialogue-box {
            flex-grow: 1;
            background-color: #e9f5ff;
            border: 2px solid var(--secondary-color);
            padding: 20px;
            border-radius: var(--border-radius);
            position: relative;
        }
        #client-dialogue-box::before {
            content: '';
            position: absolute;
            left: -20px;
            top: 30px;
            border: 10px solid transparent;
            border-right-color: var(--secondary-color);
        }
        #client-name {
            font-weight: 700;
            color: var(--primary-color);
            margin: 0 0 10px 0;
        }
        #client-dialogue {
            margin: 0;
            line-height: 1.6;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¨ãƒªã‚¢ */
        #status-area {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .status-item {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: var(--border-radius);
            border: 1px solid #eee;
        }
        .status-item .label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            margin-bottom: 10px;
        }
        .status-item .score {
            font-size: 1.2em;
            color: var(--primary-color);
        }
        .status-bar-container {
            width: 100%;
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }
        .status-bar {
            height: 100%;
            width: 50%;
            background-color: var(--secondary-color);
            border-radius: 5px;
            transition: width 0.5s ease-in-out, background-color 0.5s ease-in-out;
        }

        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ */
        #message-area {
            background-color: #f0f4f8;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            min-height: 100px;
            border-left: 5px solid var(--info-color);
        }
        #message-area h3 {
            margin-top: 0;
            color: var(--info-color);
        }

        /* é¸æŠè‚¢ã‚¨ãƒªã‚¢ */
        #choices-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .choice-button {
            background-color: var(--white-color);
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 20px;
            border-radius: var(--border-radius);
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        .choice-button:hover {
            background-color: #e9f5ff;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 82, 155, 0.15);
        }
        .choice-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* --- çµæœç”»é¢ --- */
        #result-screen {
            display: none; /* åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º */
            text-align: center;
        }
        #result-title {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .result-success { color: var(--success-color); }
        .result-failure { color: var(--danger-color); }

        #final-scores {
            margin-bottom: 30px;
        }
        #result-feedback {
            text-align: left;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: var(--border-radius);
            line-height: 1.8;
            margin-bottom: 30px;
        }
        #result-feedback h3 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-top: 0;
        }
        #replay-button {
            background-color: var(--accent-color);
            color: var(--text-color);
            border: none;
            padding: 15px 40px;
            border-radius: var(--border-radius);
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        #replay-button:hover {
            background-color: #ffca28;
            transform: scale(1.05);
        }

        /* --- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ & ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ --- */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .score-up { animation: scoreUp 0.5s ease-out; }
        @keyframes scoreUp {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); color: var(--success-color); }
            100% { transform: translateY(0); }
        }

        .score-down { animation: scoreDown 0.5s ease-out; }
        @keyframes scoreDown {
            0% { transform: translateY(0); }
            50% { transform: translateY(10px); color: var(--danger-color); }
            100% { transform: translateY(0); }
        }

        /* --- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ --- */
        @media (max-width: 768px) {
            .screen {
                padding: 20px;
            }
            #client-area {
                flex-direction: column;
                text-align: center;
            }
            #client-dialogue-box::before {
                display: none;
            }
            #choices-area {
                grid-template-columns: 1fr;
            }
            .choice-button {
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <div id="game-container">
        <!-- ã‚·ãƒŠãƒªã‚ªé¸æŠç”»é¢ -->
        <div id="scenario-selection-screen" class="screen">
            <h1>SIeräº¤æ¸‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h1>
            <p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã¨ã—ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®äº¤æ¸‰ã‚’æˆåŠŸã«å°ãã¾ã—ã‚‡ã†ã€‚</p>
            <div class="scenario-list">
                <button class="scenario-button" data-scenario="financial-spec-change">
                    <span class="industry">é‡‘èæ¥­</span>
                    æ€¥ãªä»•æ§˜å¤‰æ›´ã¸ã®å¯¾å¿œ
                </button>
                <button class="scenario-button" disabled>
                    <span class="industry">è£½é€ æ¥­</span>
                    ï¼ˆè¿‘æ—¥å…¬é–‹äºˆå®šï¼‰
                </button>
                <button class="scenario-button" disabled>
                    <span class="industry">æµé€šãƒ»å°å£²æ¥­</span>
                    ï¼ˆè¿‘æ—¥å…¬é–‹äºˆå®šï¼‰
                </button>
            </div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ ç”»é¢ -->
        <div id="game-screen" class="screen">
            <!-- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæƒ…å ± -->
            <div id="client-area">
                <div id="client-icon">ğŸ˜</div>
                <div id="client-dialogue-box">
                    <p id="client-name"></p>
                    <p id="client-dialogue"></p>
                </div>
            </div>

            <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
            <div id="status-area">
                <div class="status-item">
                    <div class="label"><span>ä¿¡é ¼åº¦</span><span id="trust-score" class="score"></span></div>
                    <div class="status-bar-container"><div id="trust-bar" class="status-bar"></div></div>
                </div>
                <div class="status-item">
                    <div class="label"><span>äºˆç®—</span><span id="budget-score" class="score"></span></div>
                    <div class="status-bar-container"><div id="budget-bar" class="status-bar"></div></div>
                </div>
                <div class="status-item">
                    <div class="label"><span>ç´æœŸ</span><span id="delivery-score" class="score"></span></div>
                    <div class="status-bar-container"><div id="delivery-bar" class="status-bar"></div></div>
                </div>
                <div class="status-item">
                    <div class="label"><span>å“è³ª</span><span id="quality-score" class="score"></span></div>
                    <div class="status-bar-container"><div id="quality-bar" class="status-bar"></div></div>
                </div>
            </div>

            <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div id="message-area">
                <h3 id="message-title">çŠ¶æ³èª¬æ˜</h3>
                <p id="message-text"></p>
            </div>

            <!-- é¸æŠè‚¢ -->
            <div id="choices-area">
                <button class="choice-button" data-choice-id="0"></button>
                <button class="choice-button" data-choice-id="1"></button>
                <button class="choice-button" data-choice-id="2"></button>
                <button class="choice-button" data-choice-id="3"></button>
            </div>
        </div>
        
        <!-- çµæœç”»é¢ -->
        <div id="result-screen" class="screen">
            <h2 id="result-title"></h2>
            <div id="final-scores"></div>
            <div id="result-feedback"></div>
            <button id="replay-button">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã™ã‚‹</button>
        </div>

    </div>

    <script>
    // --- ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
    const gameData = {
        'financial-spec-change': {
            title: 'æ€¥ãªä»•æ§˜å¤‰æ›´ã¸ã®å¯¾å¿œ',
            client: {
                name: 'ã€‡ã€‡éŠ€è¡Œãƒ»ã‚·ã‚¹ãƒ†ãƒ éƒ¨é•·',
                type: 'ã‚³ã‚¹ãƒˆæ„è­˜ã¯é«˜ã„ãŒã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆåŠŸã«ã¯å”åŠ›çš„',
                expressions: {
                    normal: 'ğŸ˜',
                    pleased: 'ğŸ™‚',
                    concerned: 'ğŸ¤”',
                    angry: 'ğŸ˜ ',
                    happy: 'ğŸ˜„'
                }
            },
            initialStatus: { trust: 60, budget: 70, delivery: 80, quality: 80 },
            goal: 'è¿½åŠ é–‹ç™ºã®ã‚¹ã‚³ãƒ¼ãƒ—ã¨è¿½åŠ äºˆç®—ã€ãã—ã¦ç´æœŸã¸ã®å½±éŸ¿ã«ã¤ã„ã¦åˆæ„å½¢æˆã‚’è¡Œã†ã€‚',
            description: 'é–‹ç™ºä¸­ã®æ¬¡æœŸå‹˜å®šç³»ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã€‡ã€‡éŠ€è¡Œã‚·ã‚¹ãƒ†ãƒ éƒ¨é•·ã‹ã‚‰ç·Šæ€¥ã®å‘¼ã³å‡ºã—ãŒã‚ã£ãŸã€‚ã©ã†ã‚„ã‚‰æ€¥ãªä»•æ§˜å¤‰æ›´ã‚’æœ›ã‚“ã§ã„ã‚‹ã‚ˆã†ã ã€‚',
            turns: [
                { // Turn 1
                    clientDialogue: 'å›ã€æ€¥ã§ç”³ã—è¨³ãªã„ã‚“ã ãŒã€å…ˆæ—¥ç™ºè¡¨ã•ã‚ŒãŸç«¶åˆä»–ç¤¾ã®æ–°ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¦‹ã¦ã€æˆ‘ã€…ã®ã‚·ã‚¹ãƒ†ãƒ ã«ã‚‚ã©ã†ã—ã¦ã‚‚è¿½åŠ ã—ãŸã„æ©Ÿèƒ½ãŒã§ããŸã‚“ã ã€‚å¯¾å¿œã§ãã‚‹ã‹ã­ï¼Ÿ',
                    clientExpression: 'concerned',
                    choices: [
                        { text: 'ã‚‚ã¡ã‚ã‚“ã§ã™ï¼ã™ãã«è¦‹ç©ã‚‚ã‚Šã¨å½±éŸ¿ç¯„å›²ã‚’èª¿æŸ»ã—ã€ã”ææ¡ˆã—ã¾ã™ã€‚', feedback: 'å‰å‘ããªå§¿å‹¢ã¯è©•ä¾¡ã•ã‚ŒãŸãŒã€ç›¸æ‰‹ã¯ã‚³ã‚¹ãƒˆã‚’æ°—ã«ã—ã¦ã„ã‚‹ã€‚', effects: { trust: 10, budget: 0, delivery: 0, quality: 0 } },
                        { text: 'æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚ã©ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‹ã€ã¾ãšã¯è©³ã—ããŠèã‹ã›ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ', feedback: 'å†·é™ãªå¯¾å¿œã§ã€ä¿¡é ¼ã‚’å¾—ãŸã€‚ã¾ãšã¯æƒ…å ±åé›†ãŒé‡è¦ã ã€‚', effects: { trust: 15, budget: 0, delivery: 0, quality: 0 } },
                        { text: 'ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã®ä»•æ§˜å¤‰æ›´ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã«å¤§ããªé…å»¶ã‚’åŠã¼ã™ãŸã‚å›°é›£ã§ã™ã€‚', feedback: 'ä¸€æ–¹çš„ãªæ‹’çµ¶ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ç¡¬åŒ–ã•ã›ã¦ã—ã¾ã£ãŸã€‚', effects: { trust: -20, budget: 0, delivery: 0, quality: 0 } },
                        { text: 'è¿½åŠ æ©Ÿèƒ½ã§ã™ã­ã€‚ã‚‚ã¡ã‚ã‚“å¯èƒ½ã§ã™ãŒã€è¿½åŠ ã®ã”äºˆç®—ã¨ç´æœŸå»¶é•·ã¯å¿…é ˆã¨ãªã‚Šã¾ã™ã€‚', feedback: 'ã„ããªã‚Šæ¡ä»¶ã‚’çªãã¤ã‘ãŸãŸã‚ã€ç›¸æ‰‹ã¯å°‘ã—è­¦æˆ’ã—ã¦ã„ã‚‹ã€‚', effects: { trust: -10, budget: 5, delivery: 5, quality: 0 } }
                    ]
                },
                { // Turn 2
                    clientDialogue: 'ã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒªã¨ã®é€£æºã‚’å¼·åŒ–ã—ã¦ã€ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã§ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³æƒ…å ±ãªã©ã‚’é€ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã„ã‚“ã ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆå‘ä¸Šã®ãŸã‚ã«å¿…é ˆã ã¨è€ƒãˆã¦ã„ã‚‹ã€‚',
                    clientExpression: 'normal',
                    choices: [
                        { text: 'ãªã‚‹ã»ã©ã€é‡è¦ãªæ©Ÿèƒ½ã§ã™ã­ã€‚æŠ€è¡“çš„ã«ã¯å¯èƒ½ã§ã™ãŒã€å½±éŸ¿ç¯„å›²ãŒåºƒã„ãŸã‚ã€è¿½åŠ ã§2ãƒ¶æœˆã®æœŸé–“ã¨2,000ä¸‡å††ã®äºˆç®—ãŒå¿…è¦ã§ã™ã€‚', feedback: 'å…·ä½“çš„ãªæ•°å­—ã‚’æç¤ºã—ãŸãŒã€ç›¸æ‰‹ã«ã¯é«˜ã™ãã‚‹ã¨æ„Ÿã˜ã‚‰ã‚ŒãŸã‚ˆã†ã ã€‚', effects: { trust: -10, budget: 15, delivery: -20, quality: 10 } },
                        { text: 'æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚ã¾ãšã¯å½±éŸ¿èª¿æŸ»ã‚’è¡Œã„ã€ã‚¹ã‚³ãƒ¼ãƒ—ã€æ¦‚ç®—è²»ç”¨ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã”æç¤ºã—ã¾ã™ã€‚1é€±é–“ãŠæ™‚é–“ã‚’ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ', feedback: 'è¨ˆç”»çš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æç¤ºã—ã€ä¿¡é ¼ã‚’å¾—ãŸã€‚', effects: { trust: 15, budget: 0, delivery: 0, quality: 5 } },
                        { text: 'ãã®æ©Ÿèƒ½ã§ã‚ã‚Œã°ã€æ—¢å­˜ã®æ”¹ä¿®ã§ãªã‚“ã¨ã‹å¯¾å¿œã§ãã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å°‘ã—èª¿æŸ»ã•ã›ã¦ãã ã•ã„ã€‚', feedback: 'å®‰æ˜“ãªç™ºè¨€ã§æœŸå¾…ã•ã›ã¦ã—ã¾ã£ãŸã€‚å“è³ªã‚„ç¾å ´ã®è² è·ãŒæ‡¸å¿µã•ã‚Œã‚‹ã€‚', effects: { trust: 5, budget: -10, delivery: -10, quality: -15 } },
                        { text: 'ç´ æ™´ã‚‰ã—ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ï¼ãœã²å®Ÿç¾ã—ã¾ã—ã‚‡ã†ã€‚äºˆç®—ã¨ç´æœŸã¯å¾Œã‹ã‚‰èª¿æ•´ã™ã‚‹ã¨ã—ã¦ã€ã¾ãšã¯ãƒãƒ¼ãƒ ã«æ¤œè¨ã‚’æŒ‡ç¤ºã—ã¾ã™ã€‚', feedback: 'ç„¡è¨ˆç”»ãªåŒæ„ã¯ã€PMã¨ã—ã¦ã®è³‡è³ªã‚’ç–‘ã‚ã‚ŒãŸã€‚', effects: { trust: -5, budget: -15, delivery: -15, quality: -10 } }
                    ]
                },
                { // Turn 3
                    clientDialogue: 'ã‚ã‹ã£ãŸã€‚ã§ã¯ã€å½±éŸ¿èª¿æŸ»ã‚’ãŠé¡˜ã„ã™ã‚‹ã€‚ãŸã ã€ã“ã¡ã‚‰ã‚‚ä¸Šå±¤éƒ¨ã¸ã®èª¬æ˜ãŒå¿…è¦ã§ã­ã€‚ã‚ã¾ã‚Šæ‚ªã„è©±ã°ã‹ã‚Šã ã¨å›°ã‚‹ã‚“ã ãŒâ€¦ã€‚',
                    clientExpression: 'concerned',
                    choices: [
                        { text: 'ã”å®‰å¿ƒãã ã•ã„ã€‚ãƒã‚¸ãƒ†ã‚£ãƒ–ãªé¢ã‚‚å¼·èª¿ã—ã¤ã¤ã€å®Ÿç¾å¯èƒ½ãªãƒ—ãƒ©ãƒ³ã‚’ã”æç¤ºã—ã¾ã™ã€‚', feedback: 'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç«‹å ´ã‚’ç†è§£ã™ã‚‹å§¿å‹¢ã‚’è¦‹ã›ã€å®‰å¿ƒã•ã›ãŸã€‚', effects: { trust: 15, budget: 0, delivery: 0, quality: 0 } },
                        { text: 'ãƒªã‚¹ã‚¯ã‚’æ­£ç›´ã«ãŠä¼ãˆã™ã‚‹ã®ãŒç§ã®å½¹ç›®ã§ã™ã€‚å³ã—ã„å†…å®¹ã«ãªã‚‹å¯èƒ½æ€§ã‚‚ã”æ‰¿çŸ¥ãŠããã ã•ã„ã€‚', feedback: 'æ­£è«–ã ãŒã€å°‘ã—çªãæ”¾ã—ãŸå°è±¡ã‚’ä¸ãˆã¦ã—ã¾ã£ãŸã€‚', effects: { trust: -10, budget: 5, delivery: 5, quality: 5 } },
                        { text: 'æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚ãªã‚‹ã¹ãäºˆç®—å†…ã§åã¾ã‚‹ã‚ˆã†ãªã€ç°¡æ˜“çš„ãªå®Ÿè£…æ¡ˆã‚‚æ¤œè¨ã—ã¦ã¿ã¾ã™ã€‚', feedback: 'ã‚³ã‚¹ãƒˆæ„è­˜ã¯è©•ä¾¡ã•ã‚ŒãŸãŒã€å“è³ªä½ä¸‹ã‚’æ‡¸å¿µã•ã‚Œã¦ã„ã‚‹ã€‚', effects: { trust: 5, budget: 5, delivery: 0, quality: -10 } },
                        { text: 'ã§ã—ãŸã‚‰ã€ä»Šå›ã®è¿½åŠ æ©Ÿèƒ½ã¯è¦‹é€ã‚‹ã¨ã„ã†ã®ã‚‚ä¸€ã¤ã®æ‰‹ã§ã™ãŒâ€¦ã„ã‹ãŒã§ã—ã‚‡ã†ã‹ï¼Ÿ', feedback: 'æ¶ˆæ¥µçš„ãªææ¡ˆã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãŒã£ã‹ã‚Šã—ã¦ã„ã‚‹ã€‚', effects: { trust: -15, budget: 0, delivery: 0, quality: 0 } }
                    ]
                },
                { // Turn 4
                    clientDialogue: 'èª¿æŸ»çµæœã‚’ã‚ã‚ŠãŒã¨ã†ã€‚ã‚„ã¯ã‚Šå½±éŸ¿ã¯å¤§ãã„ãªâ€¦ã€‚ç‰¹ã«äºˆç®—ã®2,000ä¸‡ã¯å³ã—ã„ã€‚ãªã‚“ã¨ã‹ãªã‚‰ãªã„ã‚‚ã®ã‹ã€‚',
                    clientExpression: 'concerned',
                    choices: [
                        { text: 'ã§ã¯ã€æ©Ÿèƒ½ã‚’ä¸€éƒ¨ç°¡ç•¥åŒ–ã™ã‚‹ä»£æ›¿æ¡ˆã¯ã„ã‹ãŒã§ã—ã‚‡ã†ï¼Ÿã“ã‚Œãªã‚‰1,200ä¸‡ã¾ã§åœ§ç¸®ã§ãã¾ã™ãŒã€å“è³ªã¯å°‘ã—è½ã¡ã¾ã™ã€‚', feedback: 'ä»£æ›¿æ¡ˆã®æç¤ºã¯è‰¯ã„äº¤æ¸‰ã ã€‚ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’æ˜ç¢ºã«ä¼ãˆãŸã€‚', effects: { trust: 10, budget: 5, delivery: 5, quality: -5 } },
                        { text: 'ã“ã‚ŒãŒæœ€ä½ãƒ©ã‚¤ãƒ³ã§ã™ã€‚ã“ã®äºˆç®—ãŒç¢ºä¿ã§ããªã‘ã‚Œã°ã€ã”æœŸå¾…ã®å“è³ªã¯ä¿è¨¼ã§ãã¾ã›ã‚“ã€‚', feedback: 'å¼·æ°—ãªå§¿å‹¢ãŒã€é–¢ä¿‚ã®æ‚ªåŒ–ã‚’æ‹›ã„ãŸã€‚', effects: { trust: -15, budget: 10, delivery: 0, quality: 5 } },
                        { text: 'æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚å¼Šç¤¾ã®åˆ©ç›Šã‚’å‰Šã£ã¦1,500ä¸‡ã§å¯¾å¿œã—ã¾ã™ãŒã€ã“ã‚Œä»¥ä¸Šã®å€¤å¼•ãã¯ä¸å¯èƒ½ã§ã™ã€‚', feedback: 'èº«ã‚’åˆ‡ã‚‹ææ¡ˆã«æ„Ÿè¬ã•ã‚ŒãŸãŒã€äºˆç®—ã¯å³ã—ããªã£ãŸã€‚', effects: { trust: 15, budget: -15, delivery: 0, quality: 0 } },
                        { text: 'æ®µéšçš„ãªãƒªãƒªãƒ¼ã‚¹ã‚’ææ¡ˆã—ã¾ã™ã€‚ã¾ãšã¯MVPï¼ˆMinimum Viable Productï¼‰ã‚’1,000ä¸‡ã§é–‹ç™ºã—ã€æ®‹ã‚Šã¯æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã§æ¤œè¨ã—ã¦ã¯ã„ã‹ãŒã§ã—ã‚‡ã†ã€‚', feedback: 'ç¾å®Ÿçš„ã‹ã¤å»ºè¨­çš„ãªææ¡ˆã§ã€é«˜ãè©•ä¾¡ã•ã‚ŒãŸã€‚', effects: { trust: 20, budget: 10, delivery: 10, quality: 5 } }
                    ]
                },
                { // Turn 5
                    clientDialogue: 'æ®µéšçš„ãƒªãƒªãƒ¼ã‚¹ã€ã‹ã€‚ãªã‚‹ã»ã©ã€ãã®æ‰‹ãŒã‚ã£ãŸãªã€‚ä¸Šå±¤éƒ¨ã‚‚èª¬å¾—ã—ã‚„ã™ãã†ã ã€‚ãã®æ–¹å‘ã§é€²ã‚ã¦ã‚‚ã‚‰ãŠã†ï¼',
                    clientExpression: 'pleased',
                    choices: [
                        { text: 'ãŠä»»ã›ãã ã•ã„ï¼æ—©é€Ÿã€è©³ç´°ãªè¨ˆç”»ã‚’ä½œæˆã—ã€å†åº¦ã”ææ¡ˆã—ã¾ã™ã€‚', feedback: 'ã‚¹ãƒ ãƒ¼ã‚ºãªåˆæ„å½¢æˆã«æˆåŠŸã—ãŸã€‚', effects: { trust: 15, budget: 5, delivery: 5, quality: 5 } },
                        { text: 'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã§ã¯ã€ã¾ãšã¯è¿½åŠ å¥‘ç´„ã®æ‰‹ç¶šãã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚', feedback: 'äº‹å‹™çš„ãªå¯¾å¿œãŒå°‘ã—ã ã‘ç†±ã‚’å†·ã¾ã—ã¦ã—ã¾ã£ãŸã‚ˆã†ã ã€‚', effects: { trust: -5, budget: 10, delivery: 5, quality: 5 } },
                        { text: 'ã”ç†è§£ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã“ã®æ±ºå®šãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆåŠŸã«ç¹‹ãŒã‚‹ã¨ç¢ºä¿¡ã—ã¦ã„ã¾ã™ã€‚', feedback: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæˆåŠŸã¸ã®ç†±æ„ã‚’å…±æœ‰ã—ã€ä¿¡é ¼é–¢ä¿‚ãŒã•ã‚‰ã«æ·±ã¾ã£ãŸã€‚', effects: { trust: 20, budget: 5, delivery: 5, quality: 5 } },
                        { text: 'ã§ã¯ã€ã‚¹ã‚³ãƒ¼ãƒ—ã‚’ç¢ºå®šã•ã›ã‚‹ãŸã‚ã€è¦ä»¶å®šç¾©ã®æ‰“ã¡åˆã‚ã›ã‚’å†åº¦è¨­å®šã•ã›ã¦ãã ã•ã„ã€‚', feedback: 'å …å®Ÿãªé€²è¡Œã‚’è©•ä¾¡ã•ã‚ŒãŸã€‚', effects: { trust: 10, budget: 5, delivery: 5, quality: 5 } }
                    ]
                }
            ]
        }
    };

    // --- DOMè¦ç´ ã®å–å¾— ---
    const screens = {
        scenarioSelection: document.getElementById('scenario-selection-screen'),
        game: document.getElementById('game-screen'),
        result: document.getElementById('result-screen')
    };

    const clientElements = {
        icon: document.getElementById('client-icon'),
        name: document.getElementById('client-name'),
        dialogue: document.getElementById('client-dialogue')
    };

    const statusElements = {
        trust: { score: document.getElementById('trust-score'), bar: document.getElementById('trust-bar') },
        budget: { score: document.getElementById('budget-score'), bar: document.getElementById('budget-bar') },
        delivery: { score: document.getElementById('delivery-score'), bar: document.getElementById('delivery-bar') },
        quality: { score: document.getElementById('quality-score'), bar: document.getElementById('quality-bar') }
    };

    const messageElements = {
        title: document.getElementById('message-title'),
        text: document.getElementById('message-text')
    };

    const choicesArea = document.getElementById('choices-area');
    const choiceButtons = document.querySelectorAll('.choice-button');
    const replayButton = document.getElementById('replay-button');
    const scenarioButtons = document.querySelectorAll('.scenario-button');

    // --- ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç† ---
    let currentScenario;
    let currentTurn;
    let playerStatus;

    /**
     * ã‚²ãƒ¼ãƒ ã‚’åˆæœŸåŒ–ã—ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®šã™ã‚‹
     */
    function initGame() {
        scenarioButtons.forEach(button => {
            if (!button.disabled) {
                button.addEventListener('click', () => {
                    const scenarioId = button.dataset.scenario;
                    selectScenario(scenarioId);
                });
            }
        });
        replayButton.addEventListener('click', resetGame);
        choiceButtons.forEach(button => {
            button.addEventListener('click', () => {
                handleChoice(parseInt(button.dataset.choiceId));
            });
        });
    }

    /**
     * ã‚·ãƒŠãƒªã‚ªã‚’é¸æŠã—ã€ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã™ã‚‹
     * @param {string} scenarioId - é¸æŠã•ã‚ŒãŸã‚·ãƒŠãƒªã‚ªã®ID
     */
    function selectScenario(scenarioId) {
        currentScenario = gameData[scenarioId];
        currentTurn = 0;
        playerStatus = { ...currentScenario.initialStatus };

        // ç”»é¢åˆ‡ã‚Šæ›¿ãˆ
        screens.scenarioSelection.style.display = 'none';
        screens.game.style.display = 'block';
        screens.game.classList.add('fade-in');

        // ã‚²ãƒ¼ãƒ ç”»é¢ã®åˆæœŸè¨­å®š
        clientElements.name.textContent = currentScenario.client.name;
        messageElements.title.textContent = 'çŠ¶æ³èª¬æ˜';
        messageElements.text.textContent = currentScenario.description;
        
        updateStatusUI(true); // åˆæœŸè¡¨ç¤º
        setTimeout(() => {
            displayTurn(currentTurn);
        }, 1500); // çŠ¶æ³èª¬æ˜ã‚’å°‘ã—èª­ã‚“ã§ã‹ã‚‰é–‹å§‹
    }

    /**
     * æŒ‡å®šã•ã‚ŒãŸã‚¿ãƒ¼ãƒ³ã®æƒ…å ±ã‚’ç”»é¢ã«è¡¨ç¤ºã™ã‚‹
     * @param {number} turnIndex - è¡¨ç¤ºã™ã‚‹ã‚¿ãƒ¼ãƒ³ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
     */
    function displayTurn(turnIndex) {
        const turnData = currentScenario.turns[turnIndex];
        
        // èƒŒæ™¯ã‚’å°‘ã—ãšã¤å¤‰åŒ–ã•ã›ã‚‹
        document.body.style.backgroundColor = `hsl(210, 30%, ${94 - turnIndex * 2}%)`;

        // ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆæƒ…å ±ã‚’æ›´æ–°
        clientElements.dialogue.textContent = turnData.clientDialogue;
        clientElements.icon.textContent = currentScenario.client.expressions[turnData.clientExpression];
        
        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã‚’ãƒªã‚»ãƒƒãƒˆ
        messageElements.title.textContent = 'ã‚ãªãŸã®å¿œç­”';
        messageElements.text.textContent = 'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ç™ºè¨€ã«å¯¾ã—ã€æœ€ã‚‚é©åˆ‡ãªé¸æŠè‚¢ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚';

        // é¸æŠè‚¢ã‚’æ›´æ–°
        turnData.choices.forEach((choice, index) => {
            choiceButtons[index].textContent = choice.text;
            choiceButtons[index].disabled = false;
        });
        choicesArea.classList.add('fade-in');
        setTimeout(() => choicesArea.classList.remove('fade-in'), 500);
    }

    /**
     * ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é¸æŠã‚’å‡¦ç†ã™ã‚‹
     * @param {number} choiceIndex - é¸æŠã•ã‚ŒãŸé¸æŠè‚¢ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
     */
    function handleChoice(choiceIndex) {
        // ãƒœã‚¿ãƒ³ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–
        choiceButtons.forEach(button => button.disabled = true);

        const turnData = currentScenario.turns[currentTurn];
        const choice = turnData.choices[choiceIndex];

        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°
        for (const key in choice.effects) {
            playerStatus[key] = Math.max(0, Math.min(100, playerStatus[key] + choice.effects[key]));
        }
        updateStatusUI();

        // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¡¨ç¤º
        messageElements.title.textContent = 'çµæœ';
        messageElements.text.textContent = choice.feedback;

        // æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã¸
        currentTurn++;
        setTimeout(() => {
            if (currentTurn < currentScenario.turns.length) {
                displayTurn(currentTurn);
            } else {
                showResult();
            }
        }, 2500); // ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’èª­ã‚€æ™‚é–“
    }
    
    /**
     * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹UIï¼ˆã‚¹ã‚³ã‚¢ã¨ãƒãƒ¼ï¼‰ã‚’æ›´æ–°ã™ã‚‹
     * @param {boolean} isInitial - åˆæœŸè¡¨ç¤ºã‹ã©ã†ã‹
     */
    function updateStatusUI(isInitial = false) {
        // CSSå¤‰æ•°ã®å€¤ã‚’å–å¾—
        const rootStyles = getComputedStyle(document.documentElement);
        const dangerColor = rootStyles.getPropertyValue('--danger-color').trim();
        const warningColor = rootStyles.getPropertyValue('--warning-color').trim();
        const successColor = rootStyles.getPropertyValue('--success-color').trim();

        for (const key in playerStatus) {
            const scoreElement = statusElements[key].score;
            const barElement = statusElements[key].bar;
            const oldScore = parseInt(scoreElement.textContent || '0');
            const newScore = playerStatus[key];

            scoreElement.textContent = newScore;
            barElement.style.width = `${newScore}%`;

            // ãƒãƒ¼ã®è‰²ã‚’ã‚¹ã‚³ã‚¢ã«å¿œã˜ã¦å¤‰æ›´
            if (newScore < 30) {
                barElement.style.backgroundColor = dangerColor;
            } else if (newScore < 60) {
                barElement.style.backgroundColor = warningColor;
            } else {
                barElement.style.backgroundColor = successColor;
            }

            // åˆæœŸè¡¨ç¤ºä»¥å¤–ã§ã‚¹ã‚³ã‚¢å¤‰å‹•ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
            if (!isInitial) {
                scoreElement.classList.remove('score-up', 'score-down');
                if (newScore > oldScore) {
                    void scoreElement.offsetWidth; // Reflow to restart animation
                    scoreElement.classList.add('score-up');
                } else if (newScore < oldScore) {
                    void scoreElement.offsetWidth; // Reflow
                    scoreElement.classList.add('score-down');
                }
            }
        }
    }

    /**
     * æœ€çµ‚çµæœã‚’è¡¨ç¤ºã™ã‚‹
     */
    function showResult() {
        screens.game.style.display = 'none';
        screens.result.style.display = 'block';
        screens.result.classList.add('fade-in');

        const totalScore = Object.values(playerStatus).reduce((sum, val) => sum + val, 0);
        const averageScore = totalScore / 4;

        let resultTitle, resultClass;
        if (averageScore >= 75 && playerStatus.trust >= 70) {
            resultTitle = 'äº¤æ¸‰æˆåŠŸï¼';
            resultClass = 'result-success';
            clientElements.icon.textContent = currentScenario.client.expressions.happy;
        } else if (averageScore >= 50 && playerStatus.trust >= 50) {
            resultTitle = 'äº¤æ¸‰å¦¥çµ';
            resultClass = 'result-success';
             clientElements.icon.textContent = currentScenario.client.expressions.pleased;
        } else {
            resultTitle = 'äº¤æ¸‰å¤±æ•—â€¦';
            resultClass = 'result-failure';
            clientElements.icon.textContent = currentScenario.client.expressions.angry;
        }

        const resultTitleEl = document.getElementById('result-title');
        resultTitleEl.textContent = resultTitle;
        resultTitleEl.className = resultClass;

        const finalScoresEl = document.getElementById('final-scores');
        finalScoresEl.innerHTML = `
            <h3>æœ€çµ‚ã‚¹ã‚³ã‚¢</h3>
            <p>ä¿¡é ¼åº¦: ${playerStatus.trust} | äºˆç®—: ${playerStatus.budget} | ç´æœŸ: ${playerStatus.delivery} | å“è³ª: ${playerStatus.quality}</p>
        `;

        const feedbackEl = document.getElementById('result-feedback');
        feedbackEl.innerHTML = generateFeedback(averageScore);
    }

    /**
     * æœ€çµ‚ã‚¹ã‚³ã‚¢ã«åŸºã¥ã„ãŸç·è©•ã‚’ç”Ÿæˆã™ã‚‹
     * @param {number} averageScore - 4ã¤ã®æŒ‡æ¨™ã®å¹³å‡ã‚¹ã‚³ã‚¢
     * @returns {string} - HTMLå½¢å¼ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ†ã‚­ã‚¹ãƒˆ
     */
    function generateFeedback(averageScore) {
        let feedback = '<h3>ç·è©•</h3>';
        feedback += `<p>ä»Šå›ã®äº¤æ¸‰ã®ç·åˆè©•ä¾¡ã¯ ${Math.round(averageScore)} ç‚¹ã§ã™ã€‚</p><ul>`;

        // ä¿¡é ¼åº¦
        if (playerStatus.trust >= 80) {
            feedback += '<li>ã€ä¿¡é ¼åº¦ã€‘: ç´ æ™´ã‚‰ã—ã„ï¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®é–“ã«å¼·å›ºãªä¿¡é ¼é–¢ä¿‚ã‚’ç¯‰ãã¾ã—ãŸã€‚ä»Šå¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚‚å††æ»‘ã«é€²ã‚€ã§ã—ã‚‡ã†ã€‚</li>';
        } else if (playerStatus.trust >= 60) {
            feedback += '<li>ã€ä¿¡é ¼åº¦ã€‘: è‰¯å¥½ãªé–¢ä¿‚ã‚’ç¶­æŒã§ãã¾ã—ãŸã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ã‚ãªãŸã®ææ¡ˆã«ç´å¾—ã—ã¦ã„ã¾ã™ã€‚</li>';
        } else {
            feedback += '<li>ã€ä¿¡é ¼åº¦ã€‘: é–¢ä¿‚æ§‹ç¯‰ã«èª²é¡ŒãŒæ®‹ã‚Šã¾ã—ãŸã€‚ã‚ˆã‚Šç›¸æ‰‹ã®ç«‹å ´ã‚’ç†è§£ã—ã€å…±æ„Ÿã‚’ç¤ºã™å§¿å‹¢ãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚</li>';
        }

        // äºˆç®—
        if (playerStatus.budget >= 80) {
            feedback += '<li>ã€äºˆç®—ã€‘: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åç›Šæ€§ã‚’é«˜ãä¿ã¤ã“ã¨ã«æˆåŠŸã—ã¾ã—ãŸã€‚å„ªã‚ŒãŸã‚³ã‚¹ãƒˆç®¡ç†èƒ½åŠ›ã§ã™ã€‚</li>';
        } else if (playerStatus.budget >= 50) {
            feedback += '<li>ã€äºˆç®—ã€‘: äºˆç®—ã‚’é©åˆ‡ã«ç®¡ç†ã§ãã¾ã—ãŸã€‚ç¾å®Ÿçš„ãªè½ã¨ã—æ‰€ã‚’è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã—ãŸã­ã€‚</li>';
        } else {
            feedback += '<li>ã€äºˆç®—ã€‘: äºˆç®—é¢ã§å¤§ããªè­²æ­©ã‚’ã—ã¾ã—ãŸã€‚å®‰æ˜“ãªå€¤å¼•ãã¯é¿ã‘ã€ä¾¡å€¤ã«åŸºã¥ã„ãŸææ¡ˆã‚’å¿ƒãŒã‘ã¾ã—ã‚‡ã†ã€‚</li>';
        }

        // ç´æœŸ
        if (playerStatus.delivery >= 80) {
            feedback += '<li>ã€ç´æœŸã€‘: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã—ã£ã‹ã‚Šã¨å®ˆã‚ŠæŠœãã¾ã—ãŸã€‚ç¢ºå®Ÿãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²è¡ŒãŒæœŸå¾…ã§ãã¾ã™ã€‚</li>';
        } else if (playerStatus.delivery >= 50) {
            feedback += '<li>ã€ç´æœŸã€‘: ç´æœŸã¸ã®å½±éŸ¿ã‚’æœ€å°é™ã«æŠ‘ãˆã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ç¾å®Ÿçš„ãªèª¿æ•´ãŒã§ãã¦ã„ã¾ã™ã€‚</li>';
        } else {
            feedback += '<li>ã€ç´æœŸã€‘: å¤§å¹…ãªç´æœŸé…å»¶ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚¹ã‚³ãƒ¼ãƒ—ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚„ãƒªã‚¹ã‚¯ç®¡ç†ã®å‘ä¸ŠãŒå¿…è¦ã§ã™ã€‚</li>';
        }

        // å“è³ª
        if (playerStatus.quality >= 80) {
            feedback += '<li>ã€å“è³ªã€‘: é«˜ã„å“è³ªã‚’ç¶­æŒã™ã‚‹ã“ã¨ã«æˆåŠŸã—ã¾ã—ãŸã€‚æˆæœç‰©ã«å¯¾ã™ã‚‹è©•ä¾¡ã‚‚é«˜ããªã‚‹ã§ã—ã‚‡ã†ã€‚</li>';
        } else if (playerStatus.quality >= 50) {
            feedback += '<li>ã€å“è³ªã€‘: è¦æ±‚ã•ã‚ŒãŸå“è³ªã‚’æ¦‚ã­æº€ãŸã™ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’ã†ã¾ãç®¡ç†ã§ãã¦ã„ã¾ã™ã€‚</li>';
        } else {
            feedback += '<li>ã€å“è³ªã€‘: å“è³ªé¢ã§å¦¥å”ã—ã™ããŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å®‰æ˜“ãªæ©Ÿèƒ½å‰Šæ¸›ã¯ã€é•·æœŸçš„ãªé¡§å®¢æº€è¶³åº¦ã‚’æãªã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</li>';
        }

        feedback += '</ul>';
        
        if(averageScore >= 75) {
            feedback += '<p><strong>ã€ç·æ‹¬ã€‘</strong>å…¨ä½“ã¨ã—ã¦ã€éå¸¸ã«ãƒãƒ©ãƒ³ã‚¹ã®å–ã‚ŒãŸå„ªã‚ŒãŸäº¤æ¸‰ã§ã—ãŸã€‚ç‰¹ã«ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®ä¿¡é ¼é–¢ä¿‚ã‚’è»¸ã«ã€ç¾å®Ÿçš„ãªè§£æ±ºç­–ã‚’å°ãå‡ºã™èƒ½åŠ›ã¯ç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚</p>';
        } else if (averageScore >= 50) {
            feedback += '<p><strong>ã€ç·æ‹¬ã€‘</strong>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç ´ç¶»ã•ã›ã‚‹ã“ã¨ãªãã€ãªã‚“ã¨ã‹åˆæ„å½¢æˆã«æ¼•ãç€ã‘ã¾ã—ãŸã€‚ã„ãã¤ã‹ã®æŒ‡æ¨™ã§æ”¹å–„ã®ä½™åœ°ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã®çµŒé¨“ã‚’æ¬¡ã«æ´»ã‹ã—ã¾ã—ã‚‡ã†ã€‚</p>';
        } else {
            feedback += '<p><strong>ã€ç·æ‹¬ã€‘</strong>æ®‹å¿µãªãŒã‚‰ã€äº¤æ¸‰ã¯å³ã—ã„çµæœã«çµ‚ã‚ã‚Šã¾ã—ãŸã€‚ã„ãšã‚Œã‹ã®æŒ‡æ¨™ã‚’å„ªå…ˆã™ã‚‹ã‚ã¾ã‚Šã€å…¨ä½“ã®ãƒãƒ©ãƒ³ã‚¹ãŒå´©ã‚Œã¦ã—ã¾ã£ãŸã‚ˆã†ã§ã™ã€‚ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã€ç•°ãªã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>';
        }

        return feedback;
    }

    /**
     * ã‚²ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€ã‚·ãƒŠãƒªã‚ªé¸æŠç”»é¢ã«æˆ»ã‚‹
     */
    function resetGame() {
        screens.result.style.display = 'none';
        screens.scenarioSelection.style.display = 'block';
        screens.scenarioSelection.classList.add('fade-in');
        document.body.style.backgroundColor = 'var(--bg-color)';
    }

    // --- ã‚²ãƒ¼ãƒ ã®å®Ÿè¡Œé–‹å§‹ ---
    initGame();

    </script>
</body>
</html>
